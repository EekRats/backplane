{% extends 'base.html' %}
{% block content %}
<h2>Component List</h2>
<form method="GET" action="{{ url_for('index') }}">
    <input type="text" name="q" placeholder="Search Components..." value="{{ query }}">

    <select name="status">
        <option value="">Any Status</option>
        {% for s in ['In Use', 'In Storage', 'Spare', 'Broken', 'Unknown'] %}
        <option value="{{ s }}" {% if request.args.get('status') == s %}selected{% endif %}>{{ s }}</option>
        {% endfor %}
    </select>

    <select name="type">
        <option value="">Any Type</option>
        {% for group_label, choices in type_groups %}
        <optgroup label="{{ group_label }}">
            {% for val, label in choices %}
            <option value="{{ val }}" {% if request.args.get('type') == val %}selected{% endif %}>
                {{ label }}
            </option>
            {% endfor %}
        </optgroup>
        {% endfor %}
    </select>

    <input type="submit" value="Search">
</form>
{% if query %}
<p>Showing results for "<strong>{{ query }}</strong>" - {{ components|length }} found.</p>
{% endif %}
<table>
    <tr>
        <th>Part ID</th><th>Name</th><th>Type</th><th>Year</th><th>Status</th><th>Location</th>
    </tr>
    {% for c in components %}
    <tr>
        <td><a href="{{ url_for('view_component', component_id=c.id) }}">{{ c.part_id }}</a></td>
        <td>{{ c.name }}</td>
        <td>{{ TYPE_LABELS.get(c.type, c.type) }}</td>
        <td>{{ c.year }}</td>
        <td>{{ c.status }}</td>
        <td>{{ c.location }}</td>
    </tr>
    {% endfor %}
</table>
{% endblock %}